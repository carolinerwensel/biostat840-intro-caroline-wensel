{
  "hash": "360493a2dbd5e8570cbac651bbf661a3",
  "result": {
    "markdown": "---\ntitle: \"Example analysis\"\neditor: visual\nbibliography: refs.bib\ncsl: asm.csl\n---\n\n\n## Dairy production and consumption: How have they changed overtime?\n\n![Image source: gettyimages](dairy_photo.png){fig-align=\"center\" width=\"554\"}\n\n**Intended audience**: Policy makers, government agencies, dairy farmers, the general public\n\n**Data and data directory**: The original data are from the USDA (United States Department of Agriculture). The data are also accessible via TidyTuesday.\n\n<https://www.ers.usda.gov/data-products/dairy-data/documentation/#Loc3> <https://github.com/rfordatascience/tidytuesday/tree/master/data/2019/2019-01-29>\n\n\n\n\n\n### R packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(here)\nlibrary(readxl)\nlibrary(tidyverse)\nlibrary(stringr)\nlibrary(lubridate)\nlibrary(tidytuesdayR)\n```\n:::\n\n\n### Load data\n\nThe original data and data dictionaries can be found here: <https://github.com/rfordatascience/tidytuesday/tree/master/data/2019/2019-01-29>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif(!file.exists(here(\"data\", \"milk_products_facts.RDS\"))){\nmilk_products_facts <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-01-29/milk_products_facts.csv')\nclean_cheese <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-01-29/clean_cheese.csv')\nstate_milk_production <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-01-29/state_milk_production.csv')\n\nsaveRDS(milk_products_facts, file = here(\"data\", \"milk_products_facts.RDS\"))\nsaveRDS(clean_cheese, file = here(\"data\", \"clean_cheese.RDS\"))\nsaveRDS(state_milk_production, file = here(\"data\", \"state_milk_production.RDS\"))\n}\n\nmilk_products_facts <- readRDS(here(\"data\", \"milk_products_facts.RDS\"))\nclean_cheese <- readRDS(here(\"data\", \"clean_cheese.RDS\"))\nstate_milk_production <- readRDS(here(\"data\", \"state_milk_production.RDS\"))\n```\n:::\n\n\n### Wrangle data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# milk_products_facts\nmilk_products_facts <- milk_products_facts %>%\n  rename(\"Fluid milk\" = fluid_milk) %>%\n  mutate(Cheese = cheese_american + cheese_cottage + cheese_other) %>%\n  pivot_longer(-year, names_to = \"milk_product\", values_to = \"consumption\") \n\nmilk_products_facts$milk_product <- milk_products_facts$milk_product %>%\n  str_replace_all(\"_\", \" \") %>%\n  str_to_sentence()\n\n# clean_cheese\nclean_cheese <- clean_cheese %>%\n  rename(Processed = `Total Processed Cheese Products`, \n         Natural = `Total Natural Cheese`, \n         year = Year) %>%\n  pivot_longer(-year, names_to = \"cheese_product\", values_to = \"consumption\") %>%\n  filter(year >= 1975)\n\nclean_cheese$cheese_product <- clean_cheese$cheese_product %>%\n  str_to_sentence()\n\n# state_milk_production\nstate_milk_production <- state_milk_production %>%\n  filter(year >= 1975) %>%\n  rename(milk_produced_lbs = milk_produced) %>%\n  mutate(milk_produced_tons = milk_produced_lbs/2000)\n```\n:::\n\n\n### Dairy production over time\n\n#### By region\n\nWhich United States regions produced the most dairy in 1975?\n\n\n::: {.cell .column-margin}\n\n```{.r .cell-code}\nregion_milk_production_1975 <- state_milk_production %>%\n  filter(year == 1975) %>%\n  group_by(region) %>%\n  summarise(milk_production_tons_1975 = sum(milk_produced_tons))%>%\n  arrange(desc(milk_production_tons_1975)) %>%\n  slice(1:5)\nknitr::kable(region_milk_production_1975)\n```\n\n::: {.cell-output-display}\n|region      | milk_production_tons_1975|\n|:-----------|-------------------------:|\n|Lake States |                  16128500|\n|Northeast   |                  11777500|\n|Corn Belt   |                   7824000|\n|Pacific     |                   7164000|\n|Appalachian |                   3976500|\n:::\n:::\n\n\nWhich United States regions produced the most dairy in 2017?\n\n\n::: {.cell .column-margin}\n\n```{.r .cell-code}\nregion_milk_production_2017 <- state_milk_production %>%\n  filter(year == 2017) %>%\n  group_by(region) %>%\n  summarise(milk_production_tons_2017 = sum(milk_produced_tons))%>%\n  arrange(desc(milk_production_tons_2017)) %>%\n  slice(1:5)\nknitr::kable(region_milk_production_2017)\n```\n\n::: {.cell-output-display}\n|region      | milk_production_tons_2017|\n|:-----------|-------------------------:|\n|Lake States |                  25707500|\n|Pacific     |                  24447500|\n|Mountain    |                  17694000|\n|Northeast   |                  15645000|\n|Corn Belt   |                   9098000|\n:::\n:::\n\n\nWhich United States regions produced the most milk overall?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstate_milk_production %>%\n  group_by(region) %>%\n  summarise(total_region_tons = sum(milk_produced_tons))%>%\n  arrange(desc(total_region_tons)) %>%\n  slice(1:10) %>%\n  mutate(region_order = fct_reorder(region, total_region_tons)) %>%\n  ggplot(aes(region_order, total_region_tons)) +\n  geom_col() +\n  coord_flip()+\n  labs(\n    title = \"Top 10 dairy producing regions in the United States\",\n    subtitle = \"1975 - 2017\",\n    caption = \"The Lake States and Pacific regions are the top dairy producers, overall\",\n    y = \"Tons produced\",\n    x = \"Region\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](example-analysis_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n#### By state\n\nWhich states in the United States produced the most dairy in 1975?\n\n\n::: {.cell .column-margin}\n\n```{.r .cell-code}\nstate_milk_production_1975 <- state_milk_production %>%\n  filter(year == 1975) %>%\n  group_by(state) %>%\n  summarise(milk_production_tons_1975 = sum(milk_produced_tons))%>%\n  arrange(desc(milk_production_tons_1975)) %>%\n  slice(1:5)\nknitr::kable(state_milk_production_1975)\n```\n\n::: {.cell-output-display}\n|state        | milk_production_tons_1975|\n|:------------|-------------------------:|\n|Wisconsin    |                   9450000|\n|California   |                   5426500|\n|New York     |                   4982000|\n|Minnesota    |                   4473000|\n|Pennsylvania |                   3570000|\n:::\n:::\n\n\nWhich states in the United States produced the most dairy in 2017?\n\n\n::: {.cell .column-margin}\n\n```{.r .cell-code}\nstate_milk_production_2017 <- state_milk_production %>%\n  filter(year == 2017) %>%\n  group_by(state) %>%\n  summarise(milk_production_tons_2017 = sum(milk_produced_tons))%>%\n  arrange(desc(milk_production_tons_2017)) %>%\n  slice(1:5)\nknitr::kable(state_milk_production_2017)\n```\n\n::: {.cell-output-display}\n|state      | milk_production_tons_2017|\n|:----------|-------------------------:|\n|California |                  19899000|\n|Wisconsin  |                  15160000|\n|New York   |                   7456000|\n|Idaho      |                   7313500|\n|Texas      |                   6027000|\n:::\n:::\n\n\nWhich states in the United States produced the most dairy overall?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# state_milk_production %>%\n#   filter(year == 1975 | year == 2017) %>%\n#   ggplot(aes(year, milk_produced_tons))+\n#   geom_boxplot()\n\nstate_milk_production %>%\n  group_by(state) %>%\n  summarise(total_state_tons = sum(milk_produced_tons))%>%\n  arrange(desc(total_state_tons)) %>%\n  slice(1:25) %>%\n  mutate(state = fct_reorder(state, total_state_tons)) %>%\n  ggplot(aes(state, total_state_tons)) +\n  geom_col() +\n  coord_flip()+\n  labs(\n    title = \"Top 25 dairy producing states in the United States\",\n    subtitle = \"1975 - 2017\",\n    caption = \"California, Wisconsin, and New York are the top dairy producing states, overall\",\n    y = \"Tons produced\",\n    x = \"State\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](example-analysis_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n::: callout-note\n## Dairy production has increased over time\n\nWisconsin, Califorina, and New York are the top dairy producing states and located in the top dairy producing regions: the Lake States, Pacific, and Northeast, respectively.\n:::\n\n### Dairy consumption overtime\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmilk_products_facts %>%\n  filter(milk_product == \"Fluid milk\" | milk_product == \"Cheese\") %>%\nggplot(aes(year, consumption)) + \n  geom_point(aes(color = milk_product)) +\n  geom_smooth(aes(color = milk_product))+\n  labs(\n    title = \"Consumption of milk and cheese overtime\",\n    subtitle = \"1975 - 2017\", \n    caption = \"Over time, fluid milk consumption has decreased, while cheese consumption has increased\",\n    x = \"Time (Years)\", \n    y = \"Consumption (Pounds per person)\") +\n  labs(color = \"Dairy product\") +\n  theme_minimal() +\n  theme(legend.background=element_blank(), \n        legend.key = element_blank())\n```\n\n::: {.cell-output-display}\n![](example-analysis_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n::: callout-important\n## Dairy consumption trends vary by product type\nMilk consumption has decreased, while cheese consumption has increased over time.\n:::\n\nIs natural or processed cheese more commonly consumed?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclean_cheese %>%\n  filter(cheese_product == \"Processed\" | cheese_product == \"Natural\") %>%\n  ggplot(aes(cheese_product, consumption)) +\n  geom_boxplot(aes(fill = cheese_product)) +\n  labs(\n    title = \"Consumption of proccessed and natural cheeses\",\n    subtitle = \"1975 - 2017\", \n    caption = \"Natural cheese is most commonly connsumed\",\n    x = \"Cheese type\", \n    y = \"Consumption (Pounds per person per year)\") +\n  labs(color = \"Cheese type\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](example-analysis_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nIs a certain type of cheese driving the increased rates consumption?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclean_cheese %>%\n  filter(cheese_product == \"Cheddar\" | cheese_product == \"American other\" | cheese_product == \"Mozzarella\" | cheese_product == \"Italian other\" | cheese_product == \"Swiss\" | cheese_product == \"Brick\" | cheese_product == \"Muenster\" | cheese_product == \"Cream and neufchatel\" | cheese_product == \"Blue\")%>%\nggplot(aes(year, consumption)) + \n  geom_point(aes(color = cheese_product)) +\n  geom_smooth(aes(color = cheese_product))+\n  labs(\n    title = \"Consumption of various cheese types\",\n    subtitle = \"1975 - 2017\", \n    caption = \"Cheese consumption varies by type, over time\",\n    x = \"Time (Years)\", \n    y = \"Consumption (Pounds per person)\") +\n  labs(color = \"Cheese type\") +\n  theme_minimal() +\n  theme(legend.background=element_blank(), \n        legend.key = element_blank()) +\n  facet_wrap(vars(cheese_product))\n```\n\n::: {.cell-output-display}\n![](example-analysis_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n### Results summary\n\nMilk production has increased over time. Wisconsin, Califorina, and New York are the top milk producing states and located in the top milk producing regions: the Lake States, Pacific, and Northeast, respectively. Interestingly, fluid milk consumption has decreased, while cheese consumption has increased over time. Increased cheese consumption appears to be primarily driven by the consumption of natural cheeses, and especially mozzarella. In the 1970s the an average person consumed less than 3 pounds of mozzarella per year; whereas, in 2017 the average person consumed nearly 12 pounds of mozzarella per year.\n\n### Conslusions\n\nOverall, the results suggesting that production (supply) has continued to increase while consumption (demand) has decreased seem paradoxical; however there are other factors to consider. For decades, the U.S. government has subsidized the production of milk, regardless of consumer demand [@USDA]. This is one explanation for increased production but decreased consumption of dairy. However, what's leading to decreases in consumption? Lactose intolerance is prevalent, ranging from \\~20-80% of the population and varying by ethnic group [@scrimshaw1988]. While these percentages have remained constant, we are becoming ever more aware that diet is related to health status [@micha2017]. Lactose intolerance and consumption of dairy in general have been linked to inflammation and various diseases [@bordoni2017; @ulven2019]. This has garnered significant public attention, yet many study results are contradictory and lead to confusion [@bordoni2017]. One possible explanation for increased cheese intake is that cheese is often better tolerated by lactose intolerant individuals because the fermentation process, necessary to make cheese from milk, results in decreased lactose content [@solomons2002]. More research into the immune modulating properties of food is required to better elucidate the relationship between dairy and health.\n\n### Functions used\n\n#### dplyr\n\n-   filter\n-   rename\n-   mutate\n-   group_by\n-   summarise\n-   arrange\n-   slice\n\n#### tidyr\n\n-   pivot_longer\n\n#### ggplot2\n\n-   geom_col\n-   geom_point\n-   geom-smooth\n-   geom-boxplot\n\n#### stringr\n\n-   str_replace_all\n-   str_to_sentence\n",
    "supporting": [
      "example-analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}